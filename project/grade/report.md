# 源数据
```sql
DAY        SUBJE       FULL      SCORE CLASS_RANK GRADE_RANK  AVG_SCORE
日期        科目        总分        得分       班排       级排        均分
---------- ----- ---------- ---------- ---------- ---------- ----------
2021-07-05 政治         100         69         39        189   77.84
2021-07-05 地理         100         90          9         43   84.61
2021-07-05 历史         100         94         11         41   91.66
2021-07-05 英语         150      112.5         32        165  119.45
2021-07-05 语文         150        107         27        127  107.69
2021-07-05 数学         150        109          6         46   91.52
2021-07-05 总分         550      422.5         19        113  410.33
2021-10-21 历史         100         76         11         62    70.3
2021-10-21 地理         100         73         13         13   68.41
2021-10-21 政治         100         79          5          5   69.13
2021-10-21 英语         150        110         29        148  110.12
2021-10-21 数学         150        111          3         39   89.44
2021-10-21 语文         150        109         25        112  109.78
2021-10-21 总分         550        406         12         86  380.48
2021-12-02 地理         100         70         17        164   66.31
2021-12-02 政治         100         73         16        103   68.36
2021-12-02 历史         100         63         38        184   70.73
2021-12-02 语文         150        117         16         72  113.02
2021-12-02 英语         150       87.5         40        186   103.9
2021-12-02 数学         150        110          6         56   88.73
2021-12-02 总分         550      377.5         26        139  376.39
2022-01-17 政治         100         84         10         52       0
2022-01-17 地理         100         65         27        218       0
2022-01-17 历史         100         86         15         66       0
2022-01-17 英语         150      110.5         31        157       0
2022-01-17 语文         150        106         20        123       0
2022-01-17 数学         150        107          9         64       0
2022-01-17 总分         550      409.5         13        109       0
2022-05-14 政治         100         69         35        177   76.02
2022-05-14 地理         100         79          6          6   73.28
2022-05-14 历史         100         82          6         59   74.96
2022-05-14 数学         150        132          2          5   91.87
2022-05-14 语文         150        114         13         71  108.74
2022-05-14 英语         150      100.5         36        174  109.84
2022-05-14 总分         550      428.5          8         48   385.4
```

<!-- ```sql
with tmp as (
    select  day,
            subject,
            full,
            score,
            class_rank,
            grade_rank,
            avg_score,
            avg(class_rank) over (partition by subject order by day rows between 3 preceding and current row) CA4,
            avg(class_rank) over (partition by subject order by day rows between 1 preceding and current row) CA2,
            avg(grade_rank) over (partition by subject order by day rows between 3 preceding and current row) GA4,
            avg(grade_rank) over (partition by subject order by day rows between 1 preceding and current row) GA2
    from grade
) select * from tmp;
``` -->

# 按科目分类
```sql
DAY        SUBJE       FULL      SCORE CLASS_RANK GRADE_RANK  AVG_SCORE        CA4        CA2        GA4        GA2
日期        科目        总分       分数        班排       级排      均分   四次班排    两次班排    四次级排    两次级排
---------- ----- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------
2021-07-05 地理         100         90          9         43      84.61          9          9         43         43
2021-10-21 地理         100         73         13         13      68.41         11         11         28         28
2021-12-02 地理         100         70         17        164      66.31         13         15 73.3333333       88.5
2022-01-17 地理         100         65         27        218          0       16.5         22      109.5        191
2022-05-14 地理         100         79          6          6      73.28      15.75       16.5     100.25        112

2021-07-05 历史         100         94         11         41      91.66         11         11         41         41
2021-10-21 历史         100         76         11         62       70.3         11         11       51.5       51.5
2021-12-02 历史         100         63         38        184      70.73         20       24.5 95.6666667        123
2022-01-17 历史         100         86         15         66          0      18.75       26.5      88.25        125
2022-05-14 历史         100         82          6         59      74.96       17.5       10.5      92.75       62.5

2021-07-05 数学         150        109          6         46      91.52          6          6         46         46
2021-10-21 数学         150        111          3         39      89.44        4.5        4.5       42.5       42.5
2021-12-02 数学         150        110          6         56      88.73          5        4.5         47       47.5
2022-01-17 数学         150        107          9         64          0          6        7.5      51.25         60
2022-05-14 数学         150        132          2          5      91.87          5        5.5         41       34.5

2021-07-05 英语         150      112.5         32        165     119.45         32         32        165        165
2021-10-21 英语         150        110         29        148     110.12       30.5       30.5      156.5      156.5
2021-12-02 英语         150       87.5         40        186      103.9 33.6666667       34.5 166.333333        167
2022-01-17 英语         150      110.5         31        157          0         33       35.5        164      171.5
2022-05-14 英语         150      100.5         36        174     109.84         34       33.5     166.25      165.5

2021-07-05 语文         150        107         27        127     107.69         27         27        127        127
2021-10-21 语文         150        109         25        112     109.78         25         25        112        112
2021-12-02 语文         150        117         16         72     113.02       20.5       20.5         92         92
2022-01-17 语文         150        106         20        123          0 20.3333333         18 102.333333       97.5
2022-05-14 语文         150        114         13         71     108.74       18.5       16.5       94.5         97

2021-07-05 政治         100         69         39        189      77.84         39         39        189        189
2021-10-21 政治         100         79          5          5      69.13         22         22         97         97
2021-12-02 政治         100         73         16        103      68.36         20       10.5         99         54
2022-01-17 政治         100         84         10         52          0       17.5         13      87.25       77.5
2022-05-14 政治         100         69         35        177      76.02       16.5       22.5      84.25      114.5

2021-07-05 总分         550      422.5         19        113     410.33         19         19        113        113
2021-10-21 总分         550        406         12         86     380.48       15.5       15.5       99.5       99.5
2021-12-02 总分         550      377.5         26        139     376.39         19         19 112.666667      112.5
2022-01-17 总分         550      409.5         13        109          0       17.5       19.5     111.75        124
2022-05-14 总分         550      428.5          8         48      385.4      14.75       10.5       95.5       78.5
```